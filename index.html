<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<title>For Aashiritha — A Special Message</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

:root{
  --bg1:#fff5f7;
  --bg2:#ffe1e8;
  --bg3:#ffd4e1;
  --accent:#ff69a3;
  --accent-light:#ff8bb8;
  --accent-dark:#e05589;
  --highlight:#ffb3d1;
  --text:#a0334a;
  --text-light:#b8466b;
  --card-bg:rgba(255,245,250,0.95);
  --shadow:rgba(255,105,163,0.25);
  --border:rgba(255,180,210,0.4);
}

*{box-sizing:border-box;margin:0;padding:0;}
html{font-size:16px;-webkit-text-size-adjust:100%;}
body{
  font-family:"Poppins",system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: 
    radial-gradient(circle at 20% 30%, var(--bg1) 0%, transparent 50%),
    radial-gradient(circle at 80% 70%, var(--bg2) 0%, transparent 50%),
    linear-gradient(135deg, var(--bg2) 0%, var(--bg3) 100%);
  overflow:hidden;
  color:var(--text);
  flex-direction:column;
  padding:12px;
  position:relative;
}

/* Floating background elements with parallax */
.bg-element{
  position:absolute;
  border-radius:50%;
  background:linear-gradient(45deg, var(--highlight), var(--accent-light));
  opacity:0.1;
  animation:float 6s ease-in-out infinite;
  pointer-events:none;
  transition:transform 0.1s ease-out;
}
.bg-element:nth-child(1){width:120px;height:120px;top:10%;left:5%;animation-delay:-1s;}
.bg-element:nth-child(2){width:80px;height:80px;top:60%;right:8%;animation-delay:-3s;}
.bg-element:nth-child(3){width:60px;height:60px;bottom:20%;left:20%;animation-delay:-5s;}

@keyframes float{
  0%,100%{transform:translateY(0px) rotate(0deg) scale(1);}
  33%{transform:translateY(-15px) rotate(120deg) scale(1.1);}
  66%{transform:translateY(10px) rotate(240deg) scale(0.9);}
}

/* Confetti canvas */
#confetti{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
  z-index:0;
}

/* Main card with 3D perspective */
.card{
  width:min(400px,96%);
  max-width:400px;
  padding:24px 20px;
  border-radius:24px;
  background:var(--card-bg);
  box-shadow:
    0 8px 32px var(--shadow),
    0 4px 16px rgba(255,105,163,0.15),
    inset 0 1px 2px rgba(255,255,255,0.8);
  backdrop-filter:blur(12px);
  border:1px solid var(--border);
  text-align:center;
  position:relative;
  z-index:1;
  animation:cardEntrance 1s ease-out, cardFloat 4s ease-in-out infinite 1s;
  overflow:hidden;
  transform-style:preserve-3d;
  perspective:1000px;
}

@keyframes cardEntrance{
  0%{transform:translateY(30px) scale(0.95) rotateX(-10deg); opacity:0;}
  100%{transform:translateY(0) scale(1) rotateX(0deg); opacity:1;}
}

@keyframes cardFloat{
  0%,100%{transform:translateY(0px) scale(1) rotateX(0deg); box-shadow:0 8px 32px var(--shadow);}
  50%{transform:translateY(-8px) scale(1.02) rotateX(2deg); box-shadow:0 16px 48px rgba(255,105,163,0.35);}
}

/* Card flipping animation for endings */
.card.flipping{
  animation:cardFlip 0.8s ease-in-out;
}

@keyframes cardFlip{
  0%{transform:rotateY(0deg) scale(1);}
  50%{transform:rotateY(90deg) scale(0.8);}
  100%{transform:rotateY(0deg) scale(1);}
}

/* Liquid morphing shimmer effect */
.card::before{
  content:'';
  position:absolute;
  top:-2px;
  left:-2px;
  right:-2px;
  bottom:-2px;
  background:linear-gradient(45deg, transparent, var(--highlight), transparent);
  border-radius:24px;
  opacity:0.5;
  animation:liquidShimmer 3s linear infinite;
  z-index:-1;
  filter:blur(1px);
}

@keyframes liquidShimmer{
  0%{transform:translateX(-100%) scaleY(1);}
  25%{transform:translateX(-50%) scaleY(1.2);}
  50%{transform:translateX(0%) scaleY(0.8);}
  75%{transform:translateX(50%) scaleY(1.1);}
  100%{transform:translateX(100%) scaleY(1);}
}

/* Breathing animation when idle */
.card.breathing{
  animation:breathe 3s ease-in-out infinite;
}

@keyframes breathe{
  0%,100%{transform:scale(1);}
  50%{transform:scale(1.02);}
}

/* Header with dancing letters */
h1{
  font-size:clamp(20px, 5vw, 24px);
  font-weight:700;
  color:var(--accent);
  text-shadow:0 0 20px var(--highlight);
  margin-bottom:20px;
  animation:titleGlow 2s ease-in-out infinite alternate;
}

.dancing-letter{
  display:inline-block;
  animation:letterDance 0.6s ease-in-out;
  transform-origin:center bottom;
}

@keyframes letterDance{
  0%{transform:translateY(0) rotate(0deg) scale(1);}
  25%{transform:translateY(-10px) rotate(-5deg) scale(1.1);}
  50%{transform:translateY(-5px) rotate(5deg) scale(0.9);}
  75%{transform:translateY(-8px) rotate(-2deg) scale(1.05);}
  100%{transform:translateY(0) rotate(0deg) scale(1);}
}

@keyframes titleGlow{
  from{text-shadow:0 0 20px var(--highlight), 0 0 30px var(--accent-light);}
  to{text-shadow:0 0 30px var(--accent), 0 0 40px var(--accent-dark);}
}

/* Message container with liquid effects */
.message{
  font-size:clamp(16px, 4vw, 18px);
  line-height:1.7;
  text-align:left;
  max-height:50vh;
  overflow-y:auto;
  overflow-x:hidden;
  padding:16px;
  border-radius:16px;
  background:linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,245,250,0.4));
  border:1px solid var(--border);
  box-shadow:inset 0 2px 8px rgba(255,105,163,0.1);
  margin-bottom:20px;
  scrollbar-width:thin;
  scrollbar-color:var(--accent-light) transparent;
  position:relative;
}

.message::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  bottom:0;
  background:linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
  animation:liquidFlow 4s linear infinite;
  pointer-events:none;
  border-radius:16px;
}

@keyframes liquidFlow{
  0%{transform:translateX(-100%) skewX(-20deg);}
  100%{transform:translateX(200%) skewX(-20deg);}
}

.message::-webkit-scrollbar{width:4px;}
.message::-webkit-scrollbar-track{background:transparent;}
.message::-webkit-scrollbar-thumb{background:var(--accent-light); border-radius:2px;}

/* Morphing typed lines */
.line{
  margin:12px 0;
  font-size:clamp(16px, 4vw, 18px);
  animation:lineMorphIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  transform-origin:left center;
  position:relative;
}

@keyframes lineMorphIn{
  0%{
    opacity:0; 
    transform:translateX(-30px) scale(0.8) rotate(-5deg);
    filter:blur(5px);
  }
  50%{
    transform:translateX(5px) scale(1.05) rotate(2deg);
    filter:blur(1px);
  }
  100%{
    opacity:1; 
    transform:translateX(0) scale(1) rotate(0deg);
    filter:blur(0px);
  }
}

/* Character dancing effect */
.glow{
  color:var(--accent);
  text-shadow:
    0 0 10px var(--accent-light),
    0 0 20px var(--highlight),
    0 0 30px var(--accent);
  font-weight:700;
  margin-right:4px;
  display:inline-block;
  animation:letterWiggle 2s ease-in-out infinite;
  transform-origin:center bottom;
}

@keyframes letterWiggle{
  0%,100%{transform:rotate(0deg) scale(1) translateY(0);}
  10%{transform:rotate(2deg) scale(1.02) translateY(-1px);}
  20%{transform:rotate(-1deg) scale(0.98) translateY(1px);}
  30%{transform:rotate(1deg) scale(1.01) translateY(-0.5px);}
  40%{transform:rotate(-0.5deg) scale(0.99) translateY(0.5px);}
  50%{transform:rotate(0deg) scale(1) translateY(0);}
}

.text.flowing{
  background:linear-gradient(90deg, var(--text), var(--accent), var(--text));
  background-size:200% 100%;
  background-clip:text;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:textFlow 3s linear infinite;
}

@keyframes textFlow{
  0%{background-position:200% 0;}
  100%{background-position:-200% 0;}
}

/* 3D rotating caret */
.caret{
  display:inline-block;
  width:2px;
  height:1.2em;
  background:linear-gradient(180deg, var(--accent), var(--accent-light));
  margin-left:4px;
  opacity:1;
  animation:caretPulse 1s ease-in-out infinite;
  vertical-align:text-bottom;
  border-radius:1px;
  transform-style:preserve-3d;
}

@keyframes caretPulse{
  0%,100%{opacity:1; transform:rotateY(0deg) scaleX(1);}
  25%{opacity:0.7; transform:rotateY(45deg) scaleX(1.5);}
  50%{opacity:0.3; transform:rotateY(90deg) scaleX(0.5);}
  75%{opacity:0.7; transform:rotateY(135deg) scaleX(1.5);}
}

/* Morphing meme styling */
.meme{
  font-style:italic;
  color:var(--text-light);
  margin:8px 0;
  padding:12px;
  background:linear-gradient(135deg, rgba(255,180,210,0.2), rgba(255,200,220,0.3));
  border-radius:12px;
  border-left:3px solid var(--accent-light);
  opacity:0;
  transform:translateY(20px) scale(0.9) rotateX(-10deg);
  animation:memeMorph 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  font-size:clamp(14px, 3.5vw, 16px);
  position:relative;
  overflow:hidden;
}

@keyframes memeMorph{
  0%{
    opacity:0;
    transform:translateY(20px) scale(0.9) rotateX(-10deg);
    border-radius:50px;
  }
  50%{
    transform:translateY(-5px) scale(1.05) rotateX(5deg);
    border-radius:8px;
  }
  100%{
    opacity:1;
    transform:translateY(0) scale(1) rotateX(0deg);
    border-radius:12px;
  }
}

.meme::before{
  content:'';
  position:absolute;
  top:0;
  left:-100%;
  width:100%;
  height:100%;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation:memeShine 2s ease-in-out;
}

@keyframes memeShine{
  0%{left:-100%;}
  100%{left:100%;}
}

/* Choice buttons for multiple endings */
.choice-container{
  display:none;
  flex-direction:column;
  gap:12px;
  margin:16px 0;
  animation:choicesSlideIn 0.6s ease-out;
}

.choice-container.show{
  display:flex;
}

@keyframes choicesSlideIn{
  0%{opacity:0; transform:translateY(30px);}
  100%{opacity:1; transform:translateY(0);}
}

.choice-btn{
  padding:14px 18px;
  border-radius:20px;
  border:2px solid var(--accent-light);
  background:linear-gradient(135deg, rgba(255,255,255,0.8), rgba(255,240,245,0.6));
  color:var(--text);
  font-weight:500;
  cursor:pointer;
  transition:all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  position:relative;
  overflow:hidden;
  text-align:left;
  font-size:clamp(14px, 3.5vw, 16px);
  transform-origin:center;
}

.choice-btn::before{
  content:'';
  position:absolute;
  top:50%;
  left:50%;
  width:0;
  height:0;
  background:radial-gradient(circle, var(--accent-light), var(--accent));
  border-radius:50%;
  transition:all 0.4s ease;
  transform:translate(-50%, -50%);
  z-index:-1;
}

.choice-btn:hover::before{
  width:300px;
  height:300px;
}

.choice-btn:hover{
  color:white;
  border-color:var(--accent);
  transform:translateY(-3px) scale(1.02);
  box-shadow:0 10px 25px rgba(255,105,163,0.3);
}

.choice-btn:active{
  transform:translateY(-1px) scale(0.98);
  animation:choicePulse 0.3s ease;
}

@keyframes choicePulse{
  0%{transform:scale(0.98);}
  50%{transform:scale(1.05);}
  100%{transform:scale(1);}
}

/* Multiple ending styles */
.ending{
  font-size:clamp(18px, 4.5vw, 20px);
  font-weight:600;
  margin:16px 0;
  padding:20px;
  border-radius:20px;
  text-align:center;
  position:relative;
  overflow:hidden;
  animation:endingReveal 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.ending.romantic{
  color:var(--accent-dark);
  background:linear-gradient(135deg, rgba(255,105,163,0.15), rgba(255,180,210,0.25));
  border:2px solid var(--accent-light);
  text-shadow:0 0 15px var(--accent-light);
}

.ending.friendship{
  color:#4a90e2;
  background:linear-gradient(135deg, rgba(74,144,226,0.15), rgba(120,180,255,0.25));
  border:2px solid #7bb4ff;
  text-shadow:0 0 15px #7bb4ff;
}

.ending.mysterious{
  color:#8e44ad;
  background:linear-gradient(135deg, rgba(142,68,173,0.15), rgba(180,120,255,0.25));
  border:2px solid #b478ff;
  text-shadow:0 0 15px #b478ff;
}

@keyframes endingReveal{
  0%{
    opacity:0;
    transform:scale(0.8) rotateY(-90deg);
    filter:blur(10px);
  }
  50%{
    transform:scale(1.05) rotateY(45deg);
    filter:blur(2px);
  }
  100%{
    opacity:1;
    transform:scale(1) rotateY(0deg);
    filter:blur(0px);
  }
}

/* Morphing button animations */
.btn{
  padding:12px 20px;
  border-radius:16px;
  border:2px solid var(--accent);
  background:linear-gradient(135deg, transparent, rgba(255,105,163,0.05));
  color:var(--accent);
  font-weight:600;
  font-size:clamp(14px, 3.5vw, 16px);
  cursor:pointer;
  transition:all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  position:relative;
  overflow:hidden;
  min-width:80px;
  touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;
  transform-origin:center;
}

.btn.morphing{
  animation:buttonMorph 0.6s ease-in-out;
}

@keyframes buttonMorph{
  0%{border-radius:16px; transform:scale(1);}
  25%{border-radius:50px; transform:scale(0.9) rotate(5deg);}
  50%{border-radius:8px; transform:scale(1.1) rotate(-5deg);}
  75%{border-radius:30px; transform:scale(0.95) rotate(2deg);}
  100%{border-radius:16px; transform:scale(1) rotate(0deg);}
}

.btn::before{
  content:'';
  position:absolute;
  top:50%;
  left:50%;
  width:0;
  height:0;
  background:linear-gradient(45deg, var(--accent), var(--accent-dark));
  border-radius:50%;
  transition:all 0.4s ease;
  transform:translate(-50%, -50%);
  z-index:-1;
}

.btn:hover::before{
  width:200px;
  height:200px;
}

.btn:hover{
  color:white;
  transform:translateY(-3px) scale(1.05);
  box-shadow:0 10px 30px rgba(255,105,163,0.4);
}

.btn:active{
  transform:translateY(-1px) scale(0.95);
  animation:buttonPulse 0.2s ease;
}

@keyframes buttonPulse{
  0%{transform:scale(0.95);}
  50%{transform:scale(1.1);}
  100%{transform:scale(1);}
}

.controls{
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:wrap;
}

/* Screen shake effect */
@keyframes screenShake{
  0%{transform:translateX(0);}
  10%{transform:translateX(-2px) rotate(0.5deg);}
  20%{transform:translateX(2px) rotate(-0.5deg);}
  30%{transform:translateX(-1px) rotate(0.3deg);}
  40%{transform:translateX(1px) rotate(-0.3deg);}
  50%{transform:translateX(0) rotate(0deg);}
}

.shake{
  animation:screenShake 0.5s ease-in-out;
}

/* Mobile optimizations */
@media (max-width: 480px){
  body{padding:8px;}
  .card{
    padding:20px 16px;
    border-radius:20px;
    max-height:90vh;
  }
  .message{
    max-height:45vh;
    padding:12px;
    font-size:16px;
  }
  .controls{gap:8px;}
  .btn{padding:10px 16px; min-width:70px;}
  .choice-btn{padding:12px 16px;}
}

@media (max-width: 320px){
  .card{padding:16px 12px;}
  .message{padding:10px; font-size:15px;}
  .btn{padding:8px 12px; font-size:14px;}
}

@media (max-height: 500px) and (orientation: landscape){
  .card{
    max-height:85vh;
    padding:16px;
  }
  .message{max-height:35vh;}
  h1{margin-bottom:12px;}
}

@media (prefers-reduced-motion: reduce){
  *{animation-duration:0.01ms !important; animation-iteration-count:1 !important;}
  .card{animation:none;}
  .caret{animation:none; opacity:1;}
}
</style>
</head>
<body>
<!-- Floating background elements -->
<div class="bg-element"></div>
<div class="bg-element"></div>
<div class="bg-element"></div>

<canvas id="confetti"></canvas>

<div class="card" role="region" aria-label="Special message card" id="mainCard">
  <h1 id="title">💌 A Special Message for Aashiritha</h1>
  <div class="message" id="message" aria-live="polite"></div>
  
  <!-- Choice buttons for different endings -->
  <div class="choice-container" id="choiceContainer">
    <button class="choice-btn" data-ending="romantic">
      💖 "I have feelings for you... I really like you!"
    </button>
    <button class="choice-btn" data-ending="friendship">
      🌟 "You're an amazing friend, let's keep being awesome together!"
    </button>
    <button class="choice-btn" data-ending="mysterious">
      ✨ "There's something special I want to tell you someday..."
    </button>
  </div>
  
  <div class="controls">
    <button class="btn" id="nextBtn" aria-pressed="false">Next 💖</button>
    <button class="btn" id="resetBtn" title="Start over">Reset ↺</button>
  </div>
</div>

<script>
/* Content */
const lines = [
  "A – Always cheerful and kind ✨",
  "A – Amazing at making friends smile 🌸",
  "S – Smart and creative too 🎨",
  "H – Honest and helpful in all you do 🤝",
  "I – Inspires everyone around you 🌟",
  "R – Really fun to be with 🎶",
  "I – Incredible at everything you try 💎",
  "T – Thoughtful in every way 🌷",
  "H – Happy moments are brighter with you ☀️",
  "A – Absolutely awesome, Aashiritha! 💖"
];

const memes = [
  "Naaku cheppadam koncham bayanga undi… kaani idi nijam 💌",
  "Nee choopuna chudagane naa hrudayam ullasanga untundi 😊",
  "Naaku koncham awkward ga anipistundi… kaani ninnu ishtapaduthunnanu 😅",
  "Nee gurinchi alochisthe naku chala santoshapadutundi 💖",
  "Na roju baaguntundi nee gurinchi alochisthe 😄",
  "Nen ikkada unnanu… kaani naa feelinglu chupinchalekapoyanu 💕"
];

const endings = {
  romantic: "Nee gunchi naaku feelinglu chupinchali anipistundi… ninnu chala ishtapaduthunnanu! Naa hrudayam lo nuvvu chala special place occupy chesavu. Will you be mine? 💖✨",
  friendship: "You're such an incredible person, Aashiritha! I'm so grateful to have you as a friend. Let's create more beautiful memories together and support each other always! 🌟💫",
  mysterious: "There are so many things I want to tell you, but words seem insufficient. Maybe someday, when the stars align perfectly, you'll understand what you mean to me... 🌙✨"
};

/* DOM Elements */
const messageEl = document.getElementById('message');
const nextBtn = document.getElementById('nextBtn');
const resetBtn = document.getElementById('resetBtn');
const choiceContainer = document.getElementById('choiceContainer');
const mainCard = document.getElementById('mainCard');
const title = document.getElementById('title');

let currentLine = 0;
let isTyping = false;
let selectedEnding = null;

/* Enhanced typewriter with morphing effects */
function appendLineWithTypewriter(fullLine, options = {}, done) {
  const showGlow = options.showGlow ?? true;
  const speed = options.speed ?? 32;

  isTyping = true;
  nextBtn.disabled = true;
  nextBtn.classList.add('morphing');

  const container = document.createElement('div');
  container.className = 'line';

  const firstLetter = fullLine.charAt(0);
  const rest = fullLine.slice(1);

  if (showGlow) {
    const glow = document.createElement('span');
    glow.className = 'glow';
    glow.textContent = firstLetter;
    container.appendChild(glow);
  } else {
    const plain = document.createElement('span');
    plain.textContent = firstLetter;
    container.appendChild(plain);
  }

  const textSpan = document.createElement('span');
  textSpan.className = 'text';
  container.appendChild(textSpan);

  const caret = document.createElement('span');
  caret.className = 'caret';
  container.appendChild(caret);

  messageEl.appendChild(container);
  messageEl.scrollTop = messageEl.scrollHeight;

  // Add flowing text effect
  setTimeout(() => {
    textSpan.classList.add('flowing');
  }, 500);

  let i = 0;
  function typeChunk() {
    if (i < rest.length) {
      textSpan.textContent += rest.charAt(i);
      i++;
      messageEl.scrollTop = messageEl.scrollHeight;
      
      // Add character dancing effect randomly
      if (Math.random() > 0.7) {
        const chars = textSpan.textContent.split('');
        const lastChar = chars[chars.length - 1];
        if (lastChar !== ' ') {
          makeLetterDance();
        }
      }
      
      setTimeout(typeChunk, speed);
    } else {
      caret.remove();
      isTyping = false;
      nextBtn.disabled = false;
      nextBtn.classList.remove('morphing');
      if (typeof done === 'function') done();
    }
  }
  setTimeout(typeChunk, speed);
}

/* Make title letters dance */
function makeLetterDance() {
  const letters = title.textContent.split('');
  title.innerHTML = '';
  letters.forEach((letter, index) => {
    const span = document.createElement('span');
    span.textContent = letter;
    span.className = 'dancing-letter';
    span.style.animationDelay = `${index * 0.1}s`;
    title.appendChild(span);
  });
  
  setTimeout(() => {
    title.textContent = title.textContent;
  }, 1000);
}

/* Enhanced meme display with morphing */
function showMeme() {
  const m = document.createElement('div');
  m.className = 'meme';
  m.textContent = memes[Math.floor(Math.random() * memes.length)];
  messageEl.appendChild(m);
  messageEl.scrollTop = messageEl.scrollHeight;
  
  // Add screen shake effect
  document.body.classList.add('shake');
  setTimeout(() => document.body.classList.remove('shake'), 500);
}

/* Show choices for multiple endings */
function showChoices() {
  choiceContainer.classList.add('show');
  nextBtn.style.display = 'none';
  
  // Add card breathing effect
  mainCard.classList.add('breathing');
}

/* Handle choice selection */
choiceContainer.addEventListener('click', (e) => {
  if (e.target.classList.contains('choice-btn')) {
    selectedEnding = e.target.dataset.ending;
    choiceContainer.classList.remove('show');
    
    // Add card flip animation
    mainCard.classList.add('flipping');
    
    setTimeout(() => {
      showEnding(selectedEnding);
      mainCard.classList.remove('flipping', 'breathing');
    }, 400);
  }
});

/* Display the selected ending */
function showEnding(endingType) {
  const ending =
